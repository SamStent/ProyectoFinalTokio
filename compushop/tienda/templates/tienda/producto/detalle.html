{% extends "tienda/base.html" %}
{% load i18n %}
{% load l10n %}
{% load static %}

{% block title %}{{ producto.nombre }}{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <!-- Imagen del producto -->
        <div class="col-md-6 mb-4">
            <div class="card">
                {% if producto.imagen %}
                <img src="{{ producto.imagen.url }}" class="card-img-top" alt="{{ producto.nombre }}">
                {% else %}
                <img src="https://via.placeholder.com/600x400?text=Sin+imagen" class="card-img-top" alt="Sin imagen">
                {% endif %}
                <div class="card-body">
                    <p class="card-text">{{ producto.descripcion }}</p>
                </div>
            </div>
        </div>

        <!-- Detalles del producto -->
        <div class="col-md-6">
            <h2>{{ producto.nombre }}</h2>
            <table class="table table-striped">
                <tbody>
                    <tr>
                        <th scope="row">{% trans "Categor√≠a" %}</th>
                        <td>{{ producto.categoria.nombre }}</td>
                    </tr>
                    <tr>
                        <th scope="row">{% trans "Precio" %}</th>
                        <td>
                          {% localize on %}
                            {{ producto.precio }}
                          {% endlocalize %} ‚Ç¨
                        </td>
                    </tr>
                    <tr>
                        <th scope="row">{% trans "Disponible" %}</th>
                        <td>
                            {% if producto.disponible %}
                                <span class="text-success">{% trans "S√≠" %}</span>
                            {% else %}
                                <span class="text-danger">{% trans "No" %}</span>
                            {% endif %}
                        </td>
                    </tr>
                    <tr>
                        <th scope="row">{% trans "Creado" %}</th>
                        <td>{{ producto.creado|date:"d/m/Y H:i" }}</td>
                    </tr>
                    <tr>
                        <th scope="row">{% trans "√öltima actualizaci√≥n" %}</th>
                        <td>{{ producto.actualizado|date:"d/m/Y H:i" }}</td>
                    </tr>
                </tbody>
            </table>

            <a href="{% url 'tienda:listado_productos' %}" class="btn btn-secondary mt-3">‚Üê {% trans "Volver al listado" %}</a>

            <!-- Formulario para a√±adir al carrito -->
            <form action="{% url 'carro:aniadir_a_carro' producto.id %}" method="post" class="mt-4">
                {% csrf_token %}
                {{ formulario_producto_carro.as_p }}
                <button type="submit" class="btn btn-success">
                    <i class="bi bi-cart-plus"></i> {% trans "A√±adir al carrito" %}
                </button>
            </form>

        </div>
    </div>
    {% if productos_recomendados %}
    <hr class="my-5">
    <div class="row">
      <h3 class="mb-4">üîé {% trans "Tambi√©n podr√≠a interesarte" %}</h3>
      {% for p in productos_recomendados %}
      <div class="col-md-3 col-sm-6 mb-4">
        <div class="card h-100 text-center">
          <a href="{{ p.get_absolute_url }}">
            {% if p.imagen %}
            <img src="{{ p.imagen.url }}" class="card-img-top" alt="{{ p.nombre }}">
            {% else %}
            <img src="{% static 'img/no_image.png' %}" class="card-img-top" alt="Sin imagen">
            {% endif %}
          </a>
          <div class="card-body">
            <h6 class="card-title">
              <a href="{{ p.get_absolute_url }}" class="text-decoration-none">
                {{ p.nombre }}
              </a>
            </h6>
            <p class="text-muted mb-2">
              {% localize on %}
                {{ p.precio }}
              {% endlocalize %} ‚Ç¨
            </p>
            <a href="{{ p.get_absolute_url }}" class="btn btn-sm btn-outline-primary">
              {% trans "Ver detalle" %}
            </a>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    {% endif %}
</div>
{% endblock %}
